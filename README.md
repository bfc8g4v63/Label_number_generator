# Label Number Generator

## Label Number Generator_Py v1.2.0

### 執行方式
1. 執行 **Label_number_generator_Py.exe**（應用程式）

### 功能
- 自定義 起始號 & 結束號 (SN)
- 自定義 每箱序號數量 (批次 QR Code)
- 支援多種序號格式  
  - 11 / 12 / 15 碼序號  
  - 多段複合式序號：`R5209-2508003 20250819 10578010 00000001 SC`
- 自動辨識序號規則（前綴 / 流水號 / 尾碼）
- 自動序號遞增並填零（Zero Padding）
- 掃描序號查詢，以「序號 123456789 為第 C/NO.XXXX 箱 / 棧板」格式顯示結果
- 連續查詢模式
- 匯出 `.xlsx` / `.csv` / `.xls`
- GUI 介面化操作（左側參數、右側查詢）
- 外箱模式 / 棧板模式
- 匯入 `.xls` / `.xlsx` / `.csv` 檔案後重新分箱
- 支援拖曳匯入至白色表格
- 增加 人為決策已印製的內容可選擇資料列並刪除選取列

---

## 更新紀錄

---

### v1.2.1
- 修正 序號依照來源序問題
- 修正 修改箱號後再次變更後下方預覽未重新 refresh 問題
- 增加 人為決策已印製的內容可選擇資料列並刪除選取列

### v1.2.0
- 新增「匯入拖曳提醒」  
  當匯入錯誤或收到錯誤型別（如 `bool`）時，自動跳出訊息：  
  「請將檔案拖曳至白框處。」
- 修正匯入按鈕 clicked() 傳入 `bool` 造成  
  `expected str, bytes or os.PathLike object, not bool` 的錯誤  
  → 改為 `import_button.clicked.connect(lambda: self.import_from_file())`
- 優化匯入錯誤提示，包含詳細錯誤內容
- 改善拖曳檔案判斷流程，強化副檔名檢查
- 增加 `_read_source_dataframe()` 的安全性檢查
- 增加匯入欄位不足時的保護（需至少三欄）
- 修正 `R5209-2508003 20250819 10578010 00000001 SC` 判定原則，避免影響其他序號格式
- 調整掃描序號查詢顯示內容：改為「序號 X 為第 BoxNo 箱 / 棧板」，直接帶出完整箱號或棧板編號
- 優化掃描序號比對邏輯，對欄位內容自動去除前後空白，降低 Excel 匯入格式差異造成查無資料的情況

### v1.1.0
序號規則升級
- 支援複雜序號格式（前綴＋數字＋尾碼）
- 支援 SC 結尾
- 支援多段式含空白序號
- 起訖序號前綴與尾碼一致性檢查
- 自動抽出流水號區段

新增功能
- 掃描序號查詢所在箱
- 連續掃描查詢模式
- 查詢字體放大
- UI 查詢區域重構
- 匯入 `.xls/.xlsx/.csv` 並重新分箱
- 支援拖曳匯入

修正版
- PyQt6 對齊方式更動
- 程式碼結構整理

### v1.0.9
- 新增輸出 `.xls`（Office 2003 格式）

### v1.0.8
- 更新外箱格式彈性

### v1.0.7
- 新增棧板號格式 `C/NO.TC4006F5J0251`

### v1.0.6
- 新增 外箱 / 棧板 模式切換

### v1.0.5
- 修正溢位錯誤

### v1.0.4
- 移除輸出檔案強制路徑設定

### v1.0.3
- 調整 UI 排版

### v1.0.2
- 調整排版與 QRCode 自動換行

### v1.0.1
- 修正開頭格式錯誤

---

## Label Number Generator_VBA v1.0.4

### 執行方式
1. 開啟 **Label number generator_VBA.xlsm**

### 功能
- 起訖序號產生
- 自訂每箱 SN 數量
- 自動生成標籤內容於第一分頁
- 可直接給標籤機匯入

---

### VBA 更新紀錄
- v1.0.4 修正溢位錯誤
- v1.0.3 修正函數類型
- v1.0.2 修正標籤機讀取錯誤
- v1.0.1 修正長度上限計算

---

## 備註
- Python 版：適合大量、自動化作業
- VBA 版：適合單機快速輸出
- 兩者皆可輸出標籤機相容格式