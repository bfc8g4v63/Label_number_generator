# Label Number Generator

## Label Number Generator_Py v1.3.3

### 執行方式
1. 執行 **Label_number_generator_Py.exe**（應用程式）

### 功能
- 自定義 起始號 & 結束號 (SN)
- 自定義 每箱序號數量 (批次 QR Code)
- 支援多種序號格式  
  - 11 / 12 / 15 碼序號  
  - 多段複合式序號：`R5209-2508003 20250819 10578010 00000001 SC`
- 自動辨識序號規則（前綴 / 流水號 / 尾碼）
- 自動序號遞增並填零（Zero Padding）
- 掃描序號查詢（可查箱號 / 棧板號）
- 自動去除序號空白、格式差異（支援全形/半形空白）
- 匯出 `.xlsx` / `.csv` / `.xls`
- GUI 介面化操作（左參數 / 右查詢）
- 外箱模式 / 棧板模式 / 匯入模式
- 匯入 `.xls` / `.xlsx` / `.csv` 後重新分箱
- 支援拖曳匯入
- 可人工刪除列（已印製）
- 精準比對序號（含複合式序號、多段序號）
- 棧板號與序號均加強空白過濾（正規化）

---

## 更新紀錄

### v1.3.3
- 修正指定棧板號仍殘留空白導致比對失敗
- 新增正規表示式 `\s+` 過濾所有類型空白（含 NBSP、Tab、全形空白）
- 新增 QLineEdit 自動清除貼上空白（棧板號）
- 修正多類型空白在匯入時造成序號比對錯誤
- 整合完整 PyQt6 class method（`export_to_xls`、`populate_table`）
- 修復 class 外部 method 導致 AttributeError
- 優化比對流程與錯誤訊息提示

---

### v1.3.2
- 加入完整空白過濾與棧板比對強化  
- 修正 Excel 97-2003 匯出 method 丟失  
- 修正匯入時 `sn_series` 可能未建立  

---

### v1.3.1
- 修正 xlrd 安裝需求

---

### v1.3.0
- 強化拖曳匯入判斷  
- 完整整併所有 PyQt6 UI 改版內容  
- 完整補上掃描查詢邏輯調整  
- 修正匯入來源後的自動 refresh 行為  
- 補上可人工刪除資料列（已印製）功能  
- 增加匯入後排序流程  
- 重新整合外箱(順號) / 棧板 / 匯入(非順號) 三模式邏輯  
- 支援拖曳匯入錯誤訊息提示  
- 支援重新分箱演算法更新  
- 修正起訖序號判定  
- 優化掃描序號查詢 UI  

---

### v1.2.1
- 修正序號依照來源序問題  
- 修正修改箱號後再次變更，下方預覽未重新 refresh 問題  
- 增加人工決策刪除列功能  

### v1.2.0
- 新增「匯入拖曳提醒」  
- 修正按鈕傳入 bool 導致路徑錯誤問題  
- 優化匯入錯誤提示  
- 改善拖曳副檔名判斷  
- 匯入欄位不足時保護  
- 修正複合式序號判定  
- 掃描查詢輸出格式更新  
- 掃描查詢內容自動去除空白  

---

### v1.1.0
序號規則升級  
- 支援複雜序號格式  
- 支援 SC 結尾、多段空白  
- 起訖序號一致性檢查  
- 自動抽出流水號  

新增功能  
- 掃描查詢所在箱  
- 連續查詢模式  
- 查詢字體放大  
- UI 查詢區域重構  
- 匯入並重新分箱（含拖曳）  

---

### v1.0.9
- 新增輸出 `.xls`

### v1.0.8
- 更新外箱格式彈性

### v1.0.7
- 新增棧板號格式 `C/NO.TC4006F5J0251`

### v1.0.6
- 新增 外箱 / 棧板 模式切換

### v1.0.5
- 修正溢位錯誤

### v1.0.4
- 移除輸出路徑固定設定

### v1.0.3
- 調整 UI 排版

### v1.0.2
- 更新 QRCode 自動換行

### v1.0.1
- 修正開頭格式誤判

---

## Label Number Generator_VBA v1.0.4

### 執行方式
1. 開啟 **Label number generator_VBA.xlsm**

### 功能
- 起訖序號產生  
- 每箱 SN 數量自訂  
- 自動生成標籤內容  
- 標籤機相容  

---

### VBA 更新紀錄
- v1.0.4 修正溢位錯誤  
- v1.0.3 修正函數類型  
- v1.0.2 修正標籤機讀取錯誤  
- v1.0.1 修正長度上限計算  

---

## 備註
- Python 版：大量運算、重新分箱、批次處理  
- VBA 版：單機快速輸出  
- 兩者皆支援標籤機格式  